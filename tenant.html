<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tenant | HomeWoW</title>
    <!-- Link To CSS -->
    <link rel="stylesheet" href="style.css">
    <!-- Box Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">
    <link rel="icon" href="img/icon.png" type="image/x-icon">
</head>

<body>
    <!-- Navigation Bar -->
    <header>
        <div class="nav container">
            <!-- Logo -->
            <a id="navbarhome" href="#" class="logo"><i class='bx bx-home-alt-2'></i>HomeWoW</a>
            <!-- Menu Icon -->
            <input type="checkbox" name="" id="menu">
            <label for="menu"><i class='bx bx-menu' id="menu-icon"></i></label>
            <!-- Navigation Links -->
            <ul class="navbar">
                <li><a id="navbarhome1" href="#">Home</a></li>
                <li><a href="#about">About Us</a></li>
                <li><a href="#how">How It Works</a></li>
                <li><a href="#properties">Properties</a></li>
            </ul>
            <!-- Profile Icon & Name -->
            <div class="user-profile">
                <div class="profile-info">
                    <div id="profile-picture" class="avatar"></div>
                    <span id="account-name">Loading...</span>
                </div>
                <div class="dropdown">
                    <button id="dropdown-button" onclick="toggleDropdown()"><i class='bx bx-chevron-down'></i></button>
                    <div id="dropdown-menu">
                        <li><a id="sidebar-dashboard" href="#"><i class='bx bxs-dashboard'></i>Dashboard</a></li>
                        <li><a id="tenancy" href="#"><i class='bx bx-home'></i>Tenancies</a></li>
                        <li><a id="payment" href="#"><i class='bx bx-detail'></i>Payments</a></li>
                        <li><a id="invoice" href="#"><i class='bx bx-coin-stack'></i>Invoices</a></li>
                        <li><a id="edit-profile-link" href="#" class="edit-profile"><i class='bx bx bx-user'></i>Edit
                                Profile</a></li>
                        <li><a href="/logout" class="logout"><i class='bx bx-log-out-circle'></i>Logout</a></li>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <script src="tenant.js"></script>

    <!-- Home -->
    <section class="home container" id="home">
        <div class="home-text">
            <h1>Find Your Next <br>Perfect Place <br>To Live.</h1>
        </div>
    </section>

    <!-- About Us -->
    <section class="about container" id="about">
        <div class="about-img">
            <img src="img/about.jpg" alt="">
        </div>
        <div class="about-text">
            <span>About Us</span>
            <h2>Welcome to HomeWoW</h2>
            <p>HomeWoW Rentals is your gateway to extraordinary stays. Founded with a passion for creating unforgettable
                memories, we're here to redefine your travel experience. Our commitment to excellence ensures that each
                property in our curated collection, from cozy retreats to stunning estates, is meticulously chosen to
                meet your every need. Embark on your next adventure with HomeWoW Rentals and discover the perfect blend
                of comfort, luxury, and convenience.
            </p>
            <h2>Find Your HomeWoW Moment</h2>
            <p>Explore the world of HomeWoW Rentals and uncover a world of possibilities. Our dedicated team is here to
                guide you every step of the way, whether you're seeking a romantic hideaway, a family-friendly retreat,
                or a solo escape. Start your journey today and experience the magic of HomeWoW Rentals.</p>
            <a href="#" class="btn">Learn More</a>
        </div>
    </section>

    <!-- How It Works -->
    <section class="how container" id="how">
        <div class="heading">
            <span>How It Works</span>
            <h2>3 easy steps</h2>
        </div>
        <div class="how-container container">
            <!-- Box 1 -->
            <div class="box">
                <i class='bx bx-info-circle'></i>
                <h3>Browse</h3>
                <p>Get your fingers running! Explore a world of possibilities with just a few clicks. Browse our
                    extensive
                    selection of rooms online on your PC or mobile, and embark on a journey to find your perfect
                    accommodation</p>
            </div>
            <!-- Box 2 -->
            <div class="box">
                <i class='bx bx-donate-heart'></i>
                <h3>Book</h3>
                <p>Get professional advice and the room’s availability status from our Booking Representatives – they
                    know
                    all the best places and their special features. Book a viewing online and visit the place on a
                    chosen
                    day</p>
            </div>
            <!-- Box 3 -->
            <div class="box">
                <i class='bx bx-dollar'></i>
                <h3>Pay</h3>
                <p>Make a confident decision and secure your booking with ease! Pay the advance booking fee conveniently
                    online, and take the first step towards reserving your dream accommodation. Our secure online
                    payment
                    system ensures a seamless and hassle-free experience</p>
            </div>
        </div>
    </section>

    <!-- Properties -->
    <section class="properties container" id="properties">
        <div class="heading">
            <span>Recent</span>
            <h2>Featured</h2>
            <p>Hand-picked selection of quality places</p>
        </div>
        <div class="properties-container container">
            <!-- Box 1 -->
            <div class="box">
                <img src="img/house/house1.jpg" alt="">
                <h3>RM1,999</h3>
                <div class="content">
                    <div class="text">
                        <h3>Demo Property</h3>
                        <i class='bx bx-current-location'><span>Cyberia, Cyberjaya, Selangor</span></i>
                    </div>
                    <div class="icon">
                        <i class='bx bx-bed'><span>5</span></i>
                        <i class='bx bx-bath'><span>2</span></i>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Newsletter -->
    <section class="newsletter container">
        <h2>Have Question In Mind? <br>Let Us Help You!</h2>
        <form action="">
            <input type="email" name="" id="email-box" placeholder="yourmail@gmail.com" required>
            <input type="submit" value="Send" class="btn">
        </form>
    </section>
    <!-- Footer -->
    <section class="footer">
        <div class="footer-container container">
            <h2>HomeWoW</h2>
            <p>HomeWoW isn't just about finding a place to stay – it's about discovering your ideal long-term
                home. As a leading proptech innovator, HomeWoW is dedicated to building vibrant rental communities
                tailored for long-term stays. Our O2O managed platform transforms existing properties into affordable
                and inviting homes, specifically designed for young individuals seeking comfortable and budget-friendly
                living solutions.</p>
            <div class="footer-grid">
                <div class="footer-box">
                    <h3>Company</h3>
                    <a href="why-us.html">Why Us</a>
                    <a href="contact.html">Contact Us</a>
                </div>
                <div class="footer-box">
                    <h3>Locations</h3>
                    <a href="https://maps.app.goo.gl/QPLvRfTfjxrRBpBv6" target="_blank">Cyberjaya</a>
                    <a href="https://maps.app.goo.gl/KMQxeaNwS82jfaQY6" target="_blank">Kuala Lumpur</a>
                    <a href="https://maps.app.goo.gl/pQNpoFHnwSWDx8126" target="_blank">Seri Kembangan</a>
                </div>
                <div class="footer-box">
                    <h3>Social Media</h3>
                    <div class="social">
                        <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank"><i class='bx bxl-facebook'
                                target="_blank"></i></a>
                        <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank"><i
                                class='bx bxl-twitter'></i></a>
                        <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank"><i
                                class='bx bxl-instagram'></i></a>
                    </div>
                </div>
            </div>
    </section>
    <!-- Copyright -->
    <div class="copyright">
        <p>&#169; HomeWoW All Right Reserved</p>
    </div>
</body>
<script>
    window.onload = function () {
        fetch('/current-user')
            .then(response => response.json())
            .then(user => {
                document.getElementById('account-name').textContent = user.name;

                // Update the href of the anchor dashboard link
                document.getElementById('sidebar-dashboard').href = `/tenant-dashboard.html?username=${user.name}&userType=${user.userType}&userId=${user.id}`;

                // Update the href of the edit profile link
                document.getElementById('edit-profile-link').href = `/edit-profile.html?username=${user.name}&userType=${user.userType}&userId=${user.id}`;

                // // Update the href of the  tenancy link
                document.getElementById('tenancy').href = `/tenant-tenancy.html?username=${user.name}&userType=${user.userType}&userId=${user.id}`;

                // // Update the href of the payment link
                document.getElementById('payment').href = `/tenant-payment.html?username=${user.name}&userType=${user.userType}&userId=${user.id}`;

                // // Update the href of the invoice link
                document.getElementById('invoice').href = `/tenant-invoice.html?username=${user.name}&userType=${user.userType}&userId=${user.id}`;


                // Update the href of the logo home link
                document.getElementById('navbarhome').href = `/tenant.html?username=${user.name}&userType=${user.userType}&userId=${user.id}`;

                // Update the href of the navbar home link
                document.getElementById('navbarhome1').href = `/tenant.html?username=${user.name}&userType=${user.userType}&userId=${user.id}`;
            })
        // Get the username from the URL
        const urlParams = new URLSearchParams(window.location.search);
        const username = urlParams.get('username');

        fetch('/properties')
            .then(response => response.json())
            .then(properties => {
                const propertiesContainer = document.querySelector('.properties-container');

                properties.forEach((property, index) => {
                    const imageNumber = (index % 6) + 1;
                    const propertyHtml = `
                <div class="box">
                    <img src="img/house/house${imageNumber}.jpg" alt="${property.name}">
                    <h3>RM${property.price}</h3>
                    <div class="content">
                        <div class="text">
                            <h3>${property.name}</h3>
                            <i class='bx bx-current-location'><span>${property.location}</span></i>
                        </div>
                        <div class="icon">
                            <i class='bx bx-bed'><span>${property.bedroom}</span></i>
                            <i class='bx bx-bath'><span>${property.bathroom}</span></i>
                        </div>
                    </div>
                    <button id="sentReq-${property._id}" class="btn" type="button">Sent Agreement Request</button>
                </div>
            `;
                    propertiesContainer.innerHTML += propertyHtml;
                });

                // Add event listeners to the "Sent Agreement Request" buttons
                properties.forEach(property => {
                    const button = document.getElementById(`sentReq-${property._id}`);
                    button.addEventListener('click', () => {
                        // Send the username and the current date and time with the request
                        const data = {
                            username: username,
                            date: new Date().toISOString()
                        };

                        fetch(`/properties/${property._id}/agreement-request`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(data),
                        })
                            .then(() => alert('Agreement request sent!'))
                            .catch(error => console.error('There was an error sending the agreement request', error));
                    });
                });
            })
            .catch(error => console.error('There was an error fetching the properties', error));
    };
</script>

</html>